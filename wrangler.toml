name = "custom-hosts-optimizer"
main = "src/index.ts"
compatibility_date = "2024-10-28"
compatibility_flags = ["nodejs_compat"]
assets = { directory = "public" }

# 环境变量配置
# 生产环境请使用 wrangler secret 命令设置
[vars]
# API_KEY = "your-secure-api-key"
# ENABLE_OPTIMIZATION = "false"
# 管理后台默认账户（生产环境请使用 wrangler secret 设置）
ADMIN_USERNAME = "admin"
# ADMIN_PASSWORD = "admin123"  # 请使用 wrangler secret put ADMIN_PASSWORD 设置

# KV 数据库绑定
# 请替换为您自己的 KV 命名空间 ID
[[kv_namespaces]]
binding = "custom_hosts"
id = "YOUR_KV_NAMESPACE_ID"  # 替换为你的实际 KV 命名空间 ID
preview_id = "YOUR_KV_NAMESPACE_ID"  # 替换为预览环境的 KV ID

# 监控配置
[observability]
enabled = true
head_sampling_rate = 1

# 预览环境配置
[env.preview]
name = "custom-hosts-optimizer-preview"
# 预览环境可以使用不同的 KV 命名空间
[[env.preview.kv_namespaces]]
binding = "custom_hosts"
id = "YOUR_PREVIEW_KV_NAMESPACE_ID"  # 预览环境专用的 KV 命名空间

# 预览环境变量
[env.preview.vars]
ADMIN_USERNAME = "admin"
# 预览环境可以使用不同的配置

# 定时任务配置 - 参考 TinsFox/github-hosts，每60分钟执行一次（避免过频繁更新）
[triggers]
crons = ["0 */1 * * *"]

# 多环境配置示例
# [env.staging]
# name = "github-hosts-staging"
# vars = { ENABLE_OPTIMIZATION = "true" }

# [env.production] 
# name = "github-hosts-production"
# vars = { ENABLE_OPTIMIZATION = "false" }
